---
name: Trigger Dependabot Updates

'on':
  push:
    branches: [main]
  workflow_dispatch:

permissions:
  contents: write
  pull-requests: write

jobs:
  trigger-dependabot:
    name: Trigger Dependabot Updates
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v6

      - name: Trigger Dependabot for NuGet
        run: |
          echo "Triggering Dependabot update for nuget ecosystem"
          curl -L -X POST \
            -H "Accept: application/vnd.github+json" \
            -H "Authorization: Bearer ${{ secrets.GITHUB_TOKEN }}" \
            -H "X-GitHub-Api-Version: 2022-11-28" \
            https://api.github.com/repos/${{ github.repository }}/dependabot/updates \
            -d '{"package_ecosystem":"nuget","directory":"/src"}' || true

      - name: Trigger Dependabot for GitHub Actions
        run: |
          echo "Triggering Dependabot update for github-actions"
          curl -L -X POST \
            -H "Accept: application/vnd.github+json" \
            -H "Authorization: Bearer ${{ secrets.GITHUB_TOKEN }}" \
            -H "X-GitHub-Api-Version: 2022-11-28" \
            https://api.github.com/repos/${{ github.repository }}/dependabot/updates \
            -d '{"package_ecosystem":"github-actions","directory":"/"}' \
            || true

      - name: Summary
        run: |
          echo "âœ… Dependabot update triggers sent successfully"
          echo "Note: Dependabot processes requests asynchronously"
          echo "Check 'Insights' > 'Dependency graph' > 'Dependabot'"
